{
  "code_name": "pihole_scan",
  "unique_prefix": "PIHOLE",
  "plugin_type": "device_scanner",
  "enabled": true,
  "data_source": "sqlite-db-query",
  "mapped_to_table": "CurrentScan",
  "data_filters": [
    {
      "compare_column": "Object_PrimaryID",
      "compare_operator": "==",
      "compare_field_id": "txtMacFilter",
      "compare_js_template": "'{value}'.toString()",
      "compare_use_quotes": true
    }
  ],
  "show_ui": true,
  "localized": [
    "display_name",
    "description",
    "icon"
  ],
  "display_name": [
    {
      "language_code": "en_us",
      "string": "PiHole (Device sync)"
    },
    {
      "language_code": "es_es",
      "string": "PiHole (Sincronización de dispositivos)"
    },
    {
      "language_code": "de_de",
      "string": "PiHole (Gerätesynchronisierung)"
    }
  ],
  "icon": [
    {
      "language_code": "en_us",
      "string": "<i class=\"fa-solid fa-search\"></i>"
    },
    {
      "language_code": "es_es",
      "string": "<i class=\"fa-solid fa-search\"></i>"
    },
    {
      "language_code": "de_de",
      "string": "<i class=\"fa-solid fa-search\"></i>"
    }
  ],
  "description": [
    {
      "language_code": "en_us",
      "string": "This plugin syncs devices from the PiHole database"
    },
    {
      "language_code": "es_es",
      "string": "Este complemento sincroniza dispositivos desde la base de datos de PiHole"
    },
    {
      "language_code": "de_de",
      "string": "Ein Plugin zur Gerätesynchronisierung aus einer PiHole-Datenbank."
    }
  ],
  "params": [
    {
      "name": "subnets",
      "type": "setting",
      "value": "SCAN_SUBNETS",
      "base64": true
    }
  ],
  "settings": [
    {
      "function": "RUN",
      "events": [
        "run"
      ],
      "type": "text.select",
      "default_value": "disabled",
      "options": [
        "disabled",
        "once",
        "schedule",
        "always_after_scan",
        "on_new_device"
      ],
      "localized": [
        "name",
        "description"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "When to run"
        },
        {
          "language_code": "es_es",
          "string": "Cuando ejecutar"
        },
        {
          "language_code": "de_de",
          "string": "Wann ausführen"
        }
      ],
      "description": [
        {
          "language_code": "en_us",
          "string": "Specify when your PiHole device import from the PiHole databse will run. The typical setting would be <code>schedule</code> and then you specify a cron-like schedule in the <a href=\"#PIHOLE_RUN_SCHD\"><code>PIHOLE_RUN_SCHD</code>setting</a>. If enabled, you must map the pihole db into your container to the <code>:/etc/pihole/pihole-FTL.db</code> mount path as specified in the <code>DB_PATH</code> setting."
        },
        {
          "language_code": "es_es",
          "string": "Especifique cuándo se ejecutará la importación de su dispositivo PiHole desde la base de datos de PiHole. La configuración típica sería <code>schedule</code> y luego especifica una programación similar a cron en la configuración <a href=\"#PIHOLE_RUN_SCHD\"><code>PIHOLE_RUN_SCHD</code></a>. Si está habilitado, debe asignar la base de datos pihole en su contenedor a la ruta de montaje <code>:/etc/pihole/pihole-FTL.db</code> como se especifica en la configuración <code>DB_PATH</code>."
        },
        {
          "language_code": "de_de",
          "string": "Auswählen wann der Geräteimport aus der PiHole-Datenbank laufen soll. Typischerweise wird <code>schedule</code> ausgewählt und ein cron-Intervall in der <a href=\"#PIHOLE_RUN_SCHD\"><code>PIHOLE_RUN_SCHD</code>Einstellung</a> gesetzt. Die PiHole-Datenbank muss in den Container <code>:/etc/pihole/pihole-FTL.db</code>-Mountpfad entsprechend der <code>DB_PATH</code>-Einstellung gemapped werden."
        }
      ]
    },
    {
      "function": "CMD",
      "type": "text",
      "default_value": "SELECT n.hwaddr AS Object_PrimaryID, {s-quote}null{s-quote} AS Object_SecondaryID, datetime() AS DateTime, na.ip  AS Watched_Value1, n.lastQuery AS Watched_Value2, na.name AS Watched_Value3, n.macVendor AS Watched_Value4, {s-quote}null{s-quote} AS Extra, n.hwaddr AS ForeignKey FROM EXTERNAL_PIHOLE.Network AS n LEFT JOIN EXTERNAL_PIHOLE.Network_Addresses AS na ON na.network_id = n.id WHERE n.hwaddr NOT LIKE {s-quote}ip-%{s-quote} AND n.hwaddr <> {s-quote}00:00:00:00:00:00{s-quote} AND na.ip <> null;",
      "options": [],
      "localized": [
        "name",
        "description"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "SQL to run"
        },
        {
          "language_code": "es_es",
          "string": "Consulta SQL"
        },
        {
          "language_code": "de_de",
          "string": "Auszuführende SQL-Abfrage"
        }
      ],
      "description": [
        {
          "language_code": "en_us",
          "string": "This SQL query is used to populate the coresponding UI tables under the Plugins section. This particular one selects data from a mapped PiHole SQLite database and maps it to the corresponding Plugin columns."
        },
        {
          "language_code": "es_es",
          "string": "Esta consulta SQL se usa para completar las tablas de IU correspondientes en la sección Complementos. Este en particular selecciona datos de una base de datos PiHole SQLite asignada y los asigna a las columnas correspondientes del complemento."
        },
        {
          "language_code": "de_de",
          "string": "SQL-Abfrage welche genutzt wird um die UI-Tabelle in der Plugins-Seite zu füllen. Die voreingestellte Abfrage wählt Daten aus der PiHole SQLite-Datenbank aus und schreibt diese in die entsprechenden Plugin-Spalten."
        }
      ]
    },
    {
      "function": "DB_PATH",
      "type": "text",
      "default_value": "/etc/pihole/pihole-FTL.db",
      "options": [],
      "localized": [
        "name",
        "description"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "DB Path"
        },
        {
          "language_code": "es_es",
          "string": "Ruta de la base de datos"
        },
        {
          "language_code": "de_de",
          "string": "Pfad zur Datenbank"
        }
      ],
      "description": [
        {
          "language_code": "en_us",
          "string": "Required setting for the <code>sqlite-db-query</code> plugin type. Is used to mount an external SQLite database and execute the SQL query stored in the <code>CMD</code> setting."
        },
        {
          "language_code": "es_es",
          "string": "Configuración requerida para el tipo de complemento <code>sqlite-db-query</code>. Se utiliza para montar una base de datos SQLite externa y ejecutar la consulta SQL almacenada en la configuración <code>CMD</code>."
        },
        {
          "language_code": "de_de",
          "string": "Erforderliche Einstellung für den <code>sqlite-db-query</code> Plugin-Typ. Wird verwendet, um eine externe SQLite-Datenbank zu öffnen und die SQL-Abfrage in der <code>CMD</code>-Einstellung auszuführen."
        }
      ]
    },
    {
      "function": "RUN_SCHD",
      "type": "text",
      "default_value": "*/30 * * * *",
      "options": [],
      "localized": [
        "name",
        "description"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "Schedule"
        },
        {
          "language_code": "es_es",
          "string": "Programar"
        },
        {
          "language_code": "de_de",
          "string": "Zeitplan"
        }
      ],
      "description": [
        {
          "language_code": "en_us",
          "string": "Only enabled if you select <code>schedule</code> in the <a href=\"#PIHOLE_RUN\"><code>PIHOLE_RUN</code> setting</a>. Make sure you enter the schedule in the correct cron-like format (e.g. validate at <a href=\"https://crontab.guru/\" target=\"_blank\">crontab.guru</a>). For example entering <code>*/30 * * * *</code> will run the scan every 30 minutes. Will be run NEXT time the time passes. <br/> It's recommended to use the same schedule interval for all plugins responsible for discovering new devices."
        },
        {
          "language_code": "es_es",
          "string": "Solo está habilitado si selecciona <code>schedule</code> en la configuración <a href=\"#PIHOLE_RUN\"><code>PIHOLE_RUN</code></a>. Asegúrese de ingresar la programación en el formato similar a cron correcto (por ejemplo, valide en <a href=\"https://crontab.guru/\" target=\"_blank\">crontab.guru</a>). Por ejemplo, ingresar <code>*/30 * * * *</code> ejecutará el escaneo cada 30 minutos. Se ejecutará la PRÓXIMA vez que pase el tiempo. <br/> Se recomienda utilizar el mismo intervalo de programación para todos los complementos que analizan su red."
        },
        {
          "language_code": "de_de",
          "string": "Nur aktiv, wenn <code>schedule</code> in der <a href=\"#PIHOLE_RUN\"><code>PIHOLE_RUN</code> Einstellung</a> ausgewählt wurde. Sichergehen, dass das Intervall in einem korrekten cron-ähnlichen Format angegeben wurde (z.B. auf <a href=\"https://crontab.guru/\" target=\"_blank\">crontab.guru</a> testen). <code>*/3 * * * *</code> würde den Scan alle 3 Minuten starten. Wird erst beim NÄCHSTEN Intervall ausgeführt. <br/>Es wird empfohlen, das Intervall aller Plugins, welche nach neuen Geräten suchen, auf den gleichen Wert zu setzen."
        }
      ]
    },
    {
      "function": "WATCH",
      "type": "text.multiselect",
      "default_value": [
        "Watched_Value1",
        "Watched_Value2"
      ],
      "options": [
        "Watched_Value1",
        "Watched_Value2",
        "Watched_Value3",
        "Watched_Value4"
      ],
      "localized": [
        "name",
        "description"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "Watched"
        },
        {
          "language_code": "es_es",
          "string": "Visto"
        },
        {
          "language_code": "de_de",
          "string": "Überwacht"
        }
      ],
      "description": [
        {
          "language_code": "en_us",
          "string": "Send a notification if selected values change. Use <code>CTRL + Click</code> to select/deselect. <ul> <li><code>Watched_Value1</code> is IP</li><li><code>Watched_Value2</code> is Last Query</li><li><code>Watched_Value3</code> is Name </li><li><code>Watched_Value4</code> is N/A </li></ul>"
        },
        {
          "language_code": "es_es",
          "string": "Envíe una notificación si los valores seleccionados cambian. Utilice <code>CTRL + clic</code> para seleccionar/deseleccionar. <ul> <li><code>Watched_Value1</code> es IP</li><li><code>Watched_Value2</code> es Proveedor</li><li><code>Watched_Value3</code> is es Interfaz</li><li><code>Watched_Value4</code> es N/A</li></ul>"
        },
        {
          "language_code": "de_de",
          "string": "Sende eine Benachrichtigung, wenn ein ausgwählter Wert sich ändert. <code>STRG + klicken</code> zum aus-/abwählen. <ul> <li><code>Watched_Value1</code> ist die IP</li><li><code>Watched_Value2</code> ist die letzte Abfrage</li><li><code>Watched_Value3</code> ist der Name</li><li><code>Watched_Value4</code> ist nicht in Verwendung </li></ul>"
        }
      ]
    },
    {
      "function": "REPORT_ON",
      "type": "text.multiselect",
      "default_value": [
        "new"
      ],
      "options": [
        "new",
        "watched-changed",
        "watched-not-changed",
        "missing-in-last-scan"
      ],
      "localized": [
        "name",
        "description"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "Report on"
        },
        {
          "language_code": "es_es",
          "string": "Informar sobre"
        },
        {
          "language_code": "de_de",
          "string": "Benachrichtige wenn"
        }
      ],
      "description": [
        {
          "language_code": "en_us",
          "string": "When should notification be sent out."
        },
        {
          "language_code": "es_es",
          "string": "¿Cuándo se debe enviar la notificación?."
        },
        {
          "language_code": "de_de",
          "string": "Wann Benachrichtigungen gesendet werden sollen."
        }
      ]
    }
  ],
  "database_column_definitions": [
    {
      "column": "Object_PrimaryID",
      "mapped_to_column": "cur_MAC",
      "css_classes": "col-sm-2",
      "show": true,
      "type": "device_mac",
      "default_value": "",
      "options": [],
      "localized": [
        "name"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "MAC"
        },
        {
          "language_code": "es_es",
          "string": "MAC"
        },
        {
          "language_code": "de_de",
          "string": "MAC"
        }
      ]
    },
    {
      "column": "Object_SecondaryID",
      "css_classes": "col-sm-2",
      "show": false,
      "type": "label",
      "default_value": "",
      "options": [],
      "localized": [
        "name"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "N/A"
        },
        {
          "language_code": "de_de",
          "string": "N/A"
        }
      ]
    },
    {
      "column": "Watched_Value1",
      "mapped_to_column": "cur_IP",
      "css_classes": "col-sm-2",
      "show": true,
      "type": "device_ip",
      "default_value": "",
      "options": [],
      "localized": [
        "name"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "Link to device"
        },
        {
          "language_code": "es_es",
          "string": "N/A"
        },
        {
          "language_code": "de_de",
          "string": "Link zum Gerät"
        }
      ]
    },
    {
      "column": "Watched_Value2",
      "mapped_to_column": "cur_LastQuery",
      "css_classes": "col-sm-2",
      "show": true,
      "type": "label",
      "default_value": "",
      "options": [],
      "localized": [
        "name"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "Last Query"
        },
        {
          "language_code": "de_de",
          "string": "Letzte Abfrage"
        }
      ]
    },
    {
      "column": "Watched_Value3",
      "mapped_to_column": "cur_Name",
      "css_classes": "col-sm-2",
      "show": true,
      "type": "label",
      "default_value": "",
      "options": [],
      "localized": [
        "name"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "Name"
        },
        {
          "language_code": "de_de",
          "string": "Name"
        }
      ]
    },
    {
      "column": "Watched_Value4",
      "mapped_to_column": "cur_Vendor",
      "css_classes": "col-sm-2",
      "show": true,
      "type": "label",
      "default_value": "",
      "options": [],
      "localized": [
        "name"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "Vendor"
        },
        {
          "language_code": "de_de",
          "string": "Hersteller"
        }
      ]
    },
    {
      "column": "Dummy",
      "mapped_to_column": "cur_ScanMethod",
      "mapped_to_column_data": {
        "value": "PIHOLE"
      },
      "css_classes": "col-sm-2",
      "show": true,
      "type": "label",
      "default_value": "",
      "options": [],
      "localized": [
        "name"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "Scan method"
        },
        {
          "language_code": "es_es",
          "string": "Método de escaneo"
        },
        {
          "language_code": "de_de",
          "string": "Scanmethode"
        }
      ]
    },
    {
      "column": "DateTimeCreated",
      "css_classes": "col-sm-2",
      "show": true,
      "type": "label",
      "default_value": "",
      "options": [],
      "localized": [
        "name"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "Created"
        },
        {
          "language_code": "es_es",
          "string": "Creado"
        },
        {
          "language_code": "de_de",
          "string": "Erstellt"
        }
      ]
    },
    {
      "column": "DateTimeChanged",
      "css_classes": "col-sm-2",
      "show": true,
      "type": "label",
      "default_value": "",
      "options": [],
      "localized": [
        "name"
      ],
      "name": [
        {
          "language_code": "en_us",
          "string": "Changed"
        },
        {
          "language_code": "es_es",
          "string": "Cambiado"
        },
        {
          "language_code": "de_de",
          "string": "Geändert"
        }
      ]
    }
  ]
}